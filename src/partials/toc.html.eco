<% renderToc = (items) => %>

<% if items.length == 1 and items[0].children: %>
    <%- renderToc(items[0].children) %>
<% else: %>
  <% if items.length: %>
  <ul class="toc">
    <% for item in items: %>
        <li><a href="#<%= item.id %>"><%- item.text %></a>
            <% if item.children: %>
                <%- renderToc(item.children) %>
            <% end %>
        </li>
    <% end %>
  </ul>
  <% end %>
<% end %>

<% end %>
<%= renderToc @tocItems %>
